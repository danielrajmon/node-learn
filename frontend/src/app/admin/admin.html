<div class="admin-container">
  <div class="header">
    <h1>{{ isEditMode ? 'Edit Question' : 'Create Questions' }}</h1>
  </div>

  <div class="success-message" *ngIf="successMessage">
    {{ successMessage }}
  </div>

  <div class="error-message" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <form (ngSubmit)="onSubmit()" #questionForm="ngForm" class="question-form">

    <div class="form-group">
      <label for="questionText">Question Text</label>
      <textarea
        id="questionText"
        name="questionText"
        [(ngModel)]="question.questionText"
        required
        rows="3"
        placeholder="Enter your question here..."
      ></textarea>
    </div>

    <div class="form-group">
      <label for="longAnswer">Answer</label>
      <textarea
        id="longAnswer"
        name="longAnswer"
        [(ngModel)]="question.longAnswer"
        required
        rows="6"
        placeholder="Enter the detailed answer..."
      ></textarea>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="difficulty">Difficulty</label>
        <select
          id="difficulty"
          name="difficulty"
          [(ngModel)]="question.difficulty"
          required
        >
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </div>

      <div class="form-group">
        <label for="topic">Topic</label>
        <input
          type="text"
          id="topic"
          name="topic"
          [(ngModel)]="question.topic"
          list="topicOptions"
          required
          maxlength="100"
          placeholder="Select or type topic"
        />
        <datalist id="topicOptions">
          <option *ngFor="let topic of allTopics" [value]="topic">{{ topic }}</option>
        </datalist>
      </div>
    </div>

    <div class="form-group checkbox-group">
      <label>
        <input
          type="checkbox"
          name="isActive"
          [(ngModel)]="question.isActive"
        />
        Active (visible to users)
      </label>
    </div>

    <div class="form-group">
      <label for="questionType">Question Type</label>
      <select
        id="questionType"
        name="questionType"
        [(ngModel)]="question.questionType"
        required
      >
        <option value="single_choice" selected>Single Choice</option>
        <option value="multiple_choice">Multiple Choice</option>
        <option value="text_input">Text Input</option>
      </select>
    </div>

    <div class="form-actions">
      <button type="submit" class="submit-button" *ngIf="!isEditMode" [disabled]="questionForm.invalid">Create Question</button>
      <button type="submit" class="submit-button" *ngIf="isEditMode" [disabled]="questionForm.invalid">Update Question</button>
      <button type="button" class="delete-button" *ngIf="isEditMode" (click)="deleteQuestion(editingQuestionId!)">Delete Question</button>
      <button type="button" class="cancel-button" *ngIf="isEditMode" (click)="cancelEdit()">Cancel</button>
    </div>
  </form>

  <div class="questions-list">
    <h2>Modify or Delete Questions ({{ allQuestions.length }})</h2>
    
    <div class="loading-message" *ngIf="loading">
      <p>Loading questions...</p>
    </div>
    
    <div class="no-questions" *ngIf="!loading && allQuestions.length === 0">
      <p>No questions yet. Create your first question above.</p>
    </div>
    
    <div class="table-container" *ngIf="allQuestions.length > 0">
      <table class="questions-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Question Text</th>
            <th>Difficulty</th>
            <th>Type</th>
            <th>Topic</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let q of allQuestions" 
              (click)="editQuestion(q)"
              [class.selected]="editingQuestionId === q.id"
              [class.inactive-question]="!q.isActive"
              class="clickable-row">
            <td>{{ q.id }}</td>
            <td class="question-text">{{ q.questionText }}</td>
            <td>
              <span class="badge" [ngClass]="'badge-' + q.difficulty">{{ q.difficulty }}</span>
            </td>
            <td>
              <span class="type-badge" [ngClass]="'type-badge-' + q.questionType">{{ q.questionType === 'single_choice' ? 'Single' : q.questionType === 'multiple_choice' ? 'Multiple' : 'Text' }}</span>
            </td>
            <td>{{ q.topic }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
